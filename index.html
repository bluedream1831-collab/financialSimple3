<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ETF æ¯æœˆé…æ¯è©¦ç®—</title>
    <!-- å¼•å…¥ Vue.js -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- å¼•å…¥ Bootstrap æ¨£å¼ -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f0f2f5; font-family: "Microsoft JhengHei", sans-serif; }
        .container { max-width: 800px; margin-top: 20px; padding-bottom: 100px; }
        
        /* æœˆä»½æŒ‰éˆ•å€ */
        .month-scroll { overflow-x: auto; white-space: nowrap; padding-bottom: 10px; margin-bottom: 10px; }
        .month-btn { 
            display: inline-block; width: 60px; margin-right: 5px; border-radius: 20px; 
            font-weight: bold; transition: all 0.2s;
        }
        .month-btn.active { background-color: #0d6efd; color: white; transform: scale(1.1); }

        /* è¡¨æ ¼æ¨£å¼ */
        .table-card { border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1); background: white; }
        .table th { background-color: #343a40; color: white; text-align: center; }
        .table td { vertical-align: middle; }
        
        /* äº®é»ƒåº•æ¨£å¼ (æ‚¨çš„éœ€æ±‚) */
        .highlight-row { background-color: #ffff00 !important; font-weight: bold; }
        
        /* è¼¸å…¥æ¡†æ¨£å¼ */
        input.form-control { text-align: right; border: 1px solid #ced4da; padding: 4px 8px; }
        input.form-control:focus { background-color: #e8f0fe; border-color: #0d6efd; }

        /* åº•éƒ¨åˆè¨ˆæ¬„ */
        .footer-total {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: #212529; color: #ffd700;
            padding: 15px; text-align: center;
            font-size: 1.2rem; font-weight: bold;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
            z-index: 999;
        }
        
        .badge-monthly { background-color: #6c757d; color: white; font-size: 0.7rem; padding: 2px 5px; border-radius: 4px; }
        .badge-quarter { background-color: #ffc107; color: black; font-size: 0.7rem; padding: 2px 5px; border-radius: 4px; }
    </style>
</head>
<body>

<div id="app" class="container">
    <h3 class="text-center mb-3">ğŸ“ˆ å°è‚¡ ETF æœˆé ˜é…æ¯è©¦ç®—</h3>
    <div class="text-center text-muted small mb-3">è‡ªå‹•å„²å­˜è‚¡æ•¸èˆ‡é…æ¯è¨­å®š</div>

    <!-- æœˆä»½é¸æ“‡ -->
    <div class="month-scroll text-center">
        <button v-for="m in 12" :key="m" 
                class="btn btn-outline-secondary month-btn"
                :class="{ active: currentMonth === m }"
                @click="currentMonth = m">
            {{ m }}æœˆ
        </button>
    </div>

    <!-- æ¸…å–®è¡¨æ ¼ -->
    <div class="table-card">
        <table class="table table-hover mb-0">
            <thead>
                <tr>
                    <th width="30%">ä»£è™Ÿ/åç¨±</th>
                    <th width="25%">æŒæœ‰è‚¡æ•¸</th>
                    <th width="20%">é ä¼°é…æ¯</th>
                    <th width="25%">è©¦ç®—é‡‘é¡</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="etf in filteredList" :key="etf.id" :class="{ 'highlight-row': isHighlight(etf) }">
                    <!-- åç¨±æ¬„ä½ -->
                    <td>
                        <div class="d-flex align-items-center">
                            <div>
                                <strong>{{ etf.id }}</strong><br>
                                <span style="font-size: 0.85rem;">{{ etf.name }}</span>
                                <div class="mt-1">
                                    <span v-if="etf.freq==='M'" class="badge-monthly">æœˆé…</span>
                                    <span v-else class="badge-quarter">å­£é…</span>
                                </div>
                            </div>
                        </div>
                    </td>
                    
                    <!-- è‚¡æ•¸è¼¸å…¥ -->
                    <td>
                        <input type="number" class="form-control" v-model.number="etf.shares" @input="saveData" placeholder="0">
                    </td>

                    <!-- é…æ¯è¼¸å…¥ -->
                    <td>
                        <input type="number" step="0.01" class="form-control" v-model.number="etf.dps" @input="saveData" placeholder="0.00">
                    </td>

                    <!-- é‡‘é¡è¨ˆç®— -->
                    <td class="text-end pe-3">
                        <strong :class="{'text-danger': (etf.shares*etf.dps)>0}">
                            {{ Math.round(etf.shares * etf.dps).toLocaleString() }}
                        </strong>
                    </td>
                </tr>
                
                <tr v-if="filteredList.length === 0">
                    <td colspan="4" class="text-center py-4 text-muted">æœ¬æœˆä»½ç„¡ä¸»è¦é…æ¯ ETF</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- åº•éƒ¨åˆè¨ˆ -->
    <div class="footer-total">
        {{ currentMonth }}æœˆä»½ é ä¼°é ˜æ¯ï¼šNT$ {{ totalAmount.toLocaleString() }}
    </div>
</div>

<script>
    const { createApp } = Vue;

    const app = createApp({
        data() {
            return {
                currentMonth: new Date().getMonth() + 1, // é è¨­ç•¶å‰æœˆä»½
                // freq: 'M'=æœˆé…, 'Q'=å­£é…
                // months: å­£é…çš„é…æ¯æœˆä»½
                etfs: [
                    // --- 1, 4, 7, 10 æœˆé…æ¯çµ„ (å­£é…) ---
                    { id: '0056', name: 'å…ƒå¤§é«˜è‚¡æ¯', freq: 'Q', months: [1,4,7,10], shares: 6000, dps: 1.07 },
                    { id: '00720B', name: 'å…ƒå¤§æŠ•å‚µ', freq: 'Q', months: [1,4,7,10], shares: 3000, dps: 0.00 },
                    { id: '009805', name: 'æ–°å…‰ç¾åœ‹é›»åŠ›', freq: 'Q', months: [1,4,7,10], shares: 1000, dps: 0.00 },
                    
                    // --- 2, 5, 8, 11 æœˆé…æ¯çµ„ (å­£é…) ---
                    { id: '00878', name: 'åœ‹æ³°æ°¸çºŒ', freq: 'Q', months: [2,5,8,11], shares: 7000, dps: 0.55 },
                    { id: '00850', name: 'å…ƒå¤§æ°¸çºŒ', freq: 'Q', months: [2,5,8,11], shares: 1102, dps: 0.00 },
                    { id: '00891', name: 'ä¸­ä¿¡é—œéµ', freq: 'Q', months: [2,5,8,11], shares: 12029, dps: 0.00 },
                    { id: '00740B', name: 'å…¨çƒæŠ•å‚µ', freq: 'Q', months: [2,5,8,11], shares: 1000, dps: 0.00 },
                    { id: '00900', name: 'å¯Œé‚¦ç‰¹é¸', freq: 'Q', months: [2,5,8,11], shares: 1000, dps: 0.00 },
                    { id: '00795B', name: 'ä¸­ä¿¡ç¾å‚µ', freq: 'Q', months: [2,5,8,11], shares: 1000, dps: 0.00 },

                    // --- 3, 6, 9, 12 æœˆé…æ¯çµ„ (å­£é…) ---
                    { id: '00713', name: 'é«˜æ¯ä½æ³¢', freq: 'Q', months: [3,6,9,12], shares: 3011, dps: 0.00 },
                    { id: '00915', name: 'å‡±åŸºé«˜æ¯', freq: 'Q', months: [3,6,9,12], shares: 5000, dps: 0.72 },
                    { id: '00922', name: 'åœ‹æ³°é ˜è¢–50', freq: 'Q', months: [3,10], shares: 2000, dps: 0.00 }, 

                    // --- æœˆé…æ¯çµ„ (æ¯å€‹æœˆéƒ½å‡ºç¾) ---
                    { id: '00929', name: 'å¾©è¯å°ç£ç§‘æŠ€', freq: 'M', months: [], shares: 3000, dps: 0.14 },
                    { id: '00934', name: 'ä¸­ä¿¡æˆé•·é«˜è‚¡', freq: 'M', months: [], shares: 1000, dps: 0.00 },
                    { id: '00936', name: 'å°æ–°æ°¸çºŒé«˜æ¯', freq: 'M', months: [], shares: 6000, dps: 0.00 },
                    { id: '00939', name: 'çµ±ä¸€é«˜æ¯å‹•èƒ½', freq: 'M', months: [], shares: 5000, dps: 0.00 },
                    { id: '00940', name: 'å…ƒå¤§å°ç£åƒ¹å€¼', freq: 'M', months: [], shares: 3000, dps: 0.00 },
                    { id: '00950B', name: 'å‡±åŸºAç´šå‚µ', freq: 'M', months: [], shares: 10000, dps: 0.00 },
                    { id: '00959B', name: 'å¤§è¯æŠ•ç­‰å‚µ', freq: 'M', months: [], shares: 5000, dps: 0.00 },
                    { id: '00772B', name: 'ä¸­ä¿¡é«˜è©•ç´š', freq: 'M', months: [], shares: 6334, dps: 0.00 },
                    { id: '00945B', name: 'å‡±åŸºéæŠ•ç­‰', freq: 'M', months: [], shares: 1000, dps: 0.00 },
                ]
            }
        },
        computed: {
            filteredList() {
                // 1. å…ˆç¯©é¸
                let list = this.etfs.filter(etf => {
                    if (etf.freq === 'M') return true; 
                    return etf.months.includes(this.currentMonth); 
                });
                
                // 2. æ’åºï¼šå­£é…(é»ƒåº•)å„ªå…ˆ
                return list.sort((a, b) => {
                    const isAQ = this.isHighlight(a);
                    const isBQ = this.isHighlight(b);
                    if (isAQ && !isBQ) return -1;
                    if (!isAQ && isBQ) return 1;
                    return 0;
                });
            },
            totalAmount() {
                return this.filteredList.reduce((acc, item) => {
                    return acc + Math.round((item.shares || 0) * (item.dps || 0));
                }, 0);
            }
        },
        mounted() {
            this.loadData();
        },
        methods: {
            isHighlight(etf) {
                return etf.freq !== 'M' && etf.months.includes(this.currentMonth);
            },
            saveData() {
                const dataToSave = this.etfs.map(e => ({ id: e.id, shares: e.shares, dps: e.dps }));
                localStorage.setItem('etf_calculator_data', JSON.stringify(dataToSave));
            },
            loadData() {
                const saved = localStorage.getItem('etf_calculator_data');
                if (saved) {
                    const parsed = JSON.parse(saved);
                    parsed.forEach(p => {
                        const target = this.etfs.find(e => e.id === p.id);
                        if (target) {
                            target.shares = p.shares;
                            target.dps = p.dps;
                        }
                    });
                }
            }
        }
    });

    // é—œéµä¿®æ­£ï¼šé€™è£¡åŠ ä¸Šäº† .mount('#app')
    app.mount('#app');

</script>

</body>
</html>
